create table appointment.appointment (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, specialty_id uuid not null, source varchar(30) check (source in ('SYSTEM','STAFF_CREATED','PATIENT_PORTAL','MOBILE_APP','WALK_IN')), status varchar(30) check (status in ('PENDING','CONFIRMED','CHECKED_IN','IN_PROGRESS','COMPLETED','CANCELLED','NO_SHOW')), type varchar(30) check (type in ('CONSULTATION','FOLLOW_UP','EMERGENCY','ONLINE')), created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table appointment.queue_ticket (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, queue_number varchar(10) not null, appointment_id uuid not null unique, doctor_id uuid not null, examination_id uuid unique, id uuid not null, room_id uuid not null, priority varchar(20) check (priority in ('NORMAL','HIGH')), status varchar(30) check (status in ('WAITING','CALLED','IN_SERVICE','IN_SERVICE_WAITING_RESULT','WAITING_AFTER_RESULT','SKIPPED','DONE','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table authentication.auth_token_blacklist (deleted boolean not null, version integer, created_date timestamp(6) with time zone, expires_at timestamp(6) with time zone, revoked_at timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, jti varchar(128) not null unique, created_by varchar(255), reason varchar(255), updated_by varchar(255), primary key (id));
create table authentication.login_attempt (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, status varchar(20) not null check (status in ('SUCCESS','MFA_PENDING','FAILURE','LOCKED')), ip_address varchar(45), created_by varchar(255), login_method varchar(255), updated_by varchar(255), user_agent varchar(255), primary key (id));
create table authentication.mfa_backup_code (deleted boolean not null, used boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, code_hash varchar(255) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table authentication.mfa_config (deleted boolean not null, is_primary boolean not null, revoked boolean not null, version integer, created_date timestamp(6) with time zone, last_verified_at timestamp(6) with time zone, sign_count bigint, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, mfa_type varchar(32) not null check (mfa_type in ('TOTP','SMS','EMAIL','PUSH_NOTIFICATION','PASSKEY','EMAIL_VERIFICATION')), aaguid varchar(100), credential_id varchar(200) unique, attestation_format varchar(255), contact varchar(255), created_by varchar(255), device_name varchar(255), secret varchar(255), updated_by varchar(255), public_key bytea, primary key (id));
create table authentication.oauth_account (deleted boolean not null, is_revoke boolean, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, provider varchar(20) not null check (provider in ('GOOGLE','FACEBOOK','GITHUB')), avatar_url varchar(500), created_by varchar(255), email varchar(255), name varchar(255), provider_user_id varchar(255) not null, updated_by varchar(255), primary key (id), constraint uc_oauthaccount_provider_user_id unique (provider, provider_user_id));
create table authentication.otp_challenge (attempt_count integer not null, deleted boolean not null, verified boolean not null, version integer, created_date timestamp(6) with time zone, expires_at timestamp(6) with time zone not null, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, mfa_type varchar(30) not null check (mfa_type in ('TOTP','SMS','EMAIL','PUSH_NOTIFICATION','PASSKEY','EMAIL_VERIFICATION')), code varchar(255) not null, created_by varchar(255), updated_by varchar(255), metadata jsonb, primary key (id));
create index idx_loginattempt_user_id on authentication.login_attempt (user_id);
create index idx_loginattempt_ip_address on authentication.login_attempt (ip_address);
create index idx_mfa_backup_code_user_id on authentication.mfa_backup_code (user_id);
create index idx_oauthaccount_user_id on authentication.oauth_account (user_id);
create index idx_oauthaccount_provider_user_id on authentication.oauth_account (provider_user_id);
create index idx_otpchallenge_user_id on authentication.otp_challenge (user_id);
create index idx_otpchallenge_mfa_type on authentication.otp_challenge (mfa_type);
create table billing.invoice (deleted boolean not null, paid boolean not null, total_amount numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, issue_date timestamp(6) not null, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid unique, id uuid not null, patient_id uuid not null, room_id uuid, invoice_number varchar(30) not null unique, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table billing.invoice_item (deleted boolean not null, quantity integer not null, total_price numeric(38,2) not null, unit_price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, invoice_id uuid not null, created_by varchar(255), description varchar(255) not null, updated_by varchar(255), primary key (id));
create table common.address (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, ward_id uuid, city_name varchar(255), created_by varchar(255), district_name varchar(255), street varchar(255), updated_by varchar(255), ward_name varchar(255), primary key (id));
create table common.administrative_unit (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, code varchar(10) not null unique, id uuid not null, parent_id uuid, level varchar(20) not null check (level in ('PROVINCE','DISTRICT','WARD')), name varchar(100) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table common.file_attachment (deleted boolean not null, version integer, created_date timestamp(6) with time zone, size bigint not null, updated_date timestamp(6) with time zone, id uuid not null, content_type varchar(255) not null, created_by varchar(255), entity_id varchar(255), entity_type varchar(255), file_name varchar(255) not null, updated_by varchar(255), upload_purpose varchar(255), url varchar(255) not null, primary key (id));
create table common.icd_code (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, code varchar(10) not null unique, id uuid not null, icd_version varchar(20), chapter varchar(100), created_by varchar(255), description TEXT, name varchar(255) not null, updated_by varchar(255), primary key (id));
create table common.notification (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, created_by varchar(255), message varchar(255), reference_id varchar(255), status varchar(255) check (status in ('READ','UNREAD')), title varchar(255) not null, topic varchar(255), type varchar(255) check (type in ('QUEUE_NEW','ORDER_NEW','LAB_ORDER_NEW','PAYMENT_NEW','APPOINTMENT_NEW')), updated_by varchar(255), primary key (id));
create table content_management.content (deleted boolean not null, version integer, created_date timestamp(6) with time zone, published_at timestamp(6) with time zone, updated_date timestamp(6) with time zone, author_id uuid not null, id uuid not null, status varchar(20) not null check (status in ('DRAFT','PUBLISHED','ARCHIVED')), title varchar(200) not null, slug varchar(220) not null unique, cover_image_url varchar(500), excerpt varchar(500), body jsonb not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table content_management.content_tag (content_id uuid not null, tag varchar(50) not null, primary key (content_id, tag));
create table examination.diagnosis (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null, icd_code_id uuid, id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.examination (deleted boolean not null, version integer, created_date timestamp(6) with time zone, examination_date timestamp(6) not null, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, staff_id uuid not null, status varchar(32) check (status in ('ONGOING','COMPLETED','CANCELLED')), type varchar(50) check (type in ('GENERAL','SPECIALIST','FOLLOW_UP','EMERGENCY')), created_by varchar(255), diagnosis_summary TEXT, symptom TEXT, updated_by varchar(255), primary key (id));
create table examination.prescription (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null unique, id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.prescription_item (deleted boolean not null, quantity integer, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, medicine_id uuid not null, prescription_id uuid not null, dosage varchar(50), duration varchar(50), frequency varchar(50), created_by varchar(255), instruction TEXT, updated_by varchar(255), primary key (id));
create table examination.service_catalog (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(20) not null unique, room_type varchar(50) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), category varchar(500), name varchar(500) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table examination.service_order (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid not null, id uuid not null, room_id uuid, order_code varchar(20) not null unique, status varchar(30) check (status in ('PENDING','READY','IN_PROGRESS','COMPLETED','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table examination.service_order_item (deleted boolean not null, price numeric(38,2), version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, service_id uuid not null, service_order_id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.vital_sign (deleted boolean not null, height float(53), pulse integer, respiration_rate integer, temperature float(53), version integer, weight float(53), created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null, id uuid not null, blood_pressure varchar(20), created_by varchar(255), updated_by varchar(255), primary key (id));
create table laboratory.lab_order (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid, id uuid not null, patient_id uuid not null, requested_by uuid not null, room_id uuid, order_code varchar(30) not null unique, status varchar(30) check (status in ('PENDING','IN_PROGRESS','COMPLETED','VERIFIED','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table laboratory.lab_test (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(20) not null unique, unit varchar(50), name varchar(150) not null, reference_range varchar(300), category varchar(500), created_by varchar(255), description TEXT, room_type varchar(255) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), updated_by varchar(255), primary key (id));
create table laboratory.lab_test_result (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, verified_at timestamp(6), id uuid not null, lab_order_id uuid not null, lab_test_id uuid not null, verified_by uuid, status varchar(30) check (status in ('PENDING','IN_PROGRESS','COMPLETED','VERIFIED','CANCELLED')), unit varchar(50), result_value varchar(100), reference_range varchar(500), created_by varchar(255), remark TEXT, updated_by varchar(255), primary key (id));
create table medical_staff_management.position (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, position_code varchar(20) not null unique, title varchar(100) not null unique, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table medical_staff_management.specialty (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, created_by varchar(255), description varchar(255), name varchar(255) not null, updated_by varchar(255), primary key (id));
create table medical_staff_management.staff (deleted boolean not null, experience_years integer, joined_date date, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, position_id uuid, specialty_id uuid, user_id uuid not null unique, staff_type varchar(32) check (staff_type in ('DOCTOR','NURSE','TECHNICIAN','LAB_TECHNICIAN','PHARMACIST','RECEPTIONIST','CASHIER','MANAGER','SYSTEM_ADMIN')), bio TEXT, created_by varchar(255), education varchar(255), email varchar(255) unique, full_name varchar(255), license_number varchar(255), phone varchar(255) unique, updated_by varchar(255), primary key (id));
create table medical_staff_management.staff_schedule (date date not null, deleted boolean not null, end_time time(6) not null, start_time time(6) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, room_id uuid not null, staff_id uuid not null, note varchar(500), created_by varchar(255), status varchar(255) not null check (status in ('AVAILABLE','OFF','CANCELLED','CHANGED')), updated_by varchar(255), primary key (id), constraint uk_staff_date_room_time unique (staff_id, date, room_id, start_time, end_time));
create table medical_staff_management.staff_schedule_template (active boolean not null, deleted boolean not null, end_time time(6) not null, start_time time(6) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, room_id uuid not null, staff_id uuid not null, created_by varchar(255), day_of_week varchar(255) not null check (day_of_week in ('MONDAY','TUESDAY','WEDNESDAY','THURSDAY','FRIDAY','SATURDAY','SUNDAY')), updated_by varchar(255), primary key (id));
create table organization.clinic (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, address_id uuid unique, id uuid not null, phone varchar(20), account_number varchar(50), tax_code varchar(50), email varchar(100), bank_name varchar(150), name varchar(150) not null unique, website varchar(150), created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table organization.department (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, clinic_id uuid not null, id uuid not null, name varchar(100) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table organization.room (capacity integer, deleted boolean not null, floor_number integer, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, room_type varchar(50) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), name varchar(100) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table patient.allergy (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, severity varchar(50), substance varchar(100) not null, created_by varchar(255), reaction TEXT, updated_by varchar(255), primary key (id));
create table patient.emergency_contact (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, phone varchar(20) not null, relationship varchar(50), full_name varchar(150) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table patient.medical_record (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid unique, id uuid not null, patient_id uuid not null, record_code varchar(20) not null unique, created_by varchar(255), diagnosis TEXT, treatment TEXT, updated_by varchar(255), primary key (id));
create table patient.patient (date_of_birth date, deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, gender varchar(10) check (gender in ('MALE','FEMALE','OTHER')), id uuid not null, user_id uuid not null unique, blood_type varchar(20) check (blood_type in ('A_POSITIVE','A_NEGATIVE','B_POSITIVE','B_NEGATIVE','AB_POSITIVE','AB_NEGATIVE','O_POSITIVE','O_NEGATIVE')), insurance_number varchar(20), patient_code varchar(20) not null unique, phone varchar(20), status varchar(20) check (status in ('ACTIVE','INACTIVE','DECEASED','TRANSFERRED')), email varchar(100), full_name varchar(150) not null, address varchar(255), created_by varchar(255), init_password varchar(255), updated_by varchar(255), primary key (id));
create table pharmacy.dispense_record (deleted boolean not null, total_cost numeric(38,2), version integer, created_date timestamp(6) with time zone, dispensed_at timestamp(6), updated_date timestamp(6) with time zone, dispensed_by uuid, id uuid not null, patient_id uuid not null, prescription_id uuid not null unique, room_id uuid, status varchar(30) check (status in ('PENDING','DISPENSED','CANCELLED')), created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table pharmacy.medicine (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(30) not null unique, unit varchar(30), strength varchar(50), dosage_form varchar(100), name varchar(100) not null, active_ingredient varchar(500), created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table user_management.device_session (deleted boolean not null, remember_me boolean not null, revoked boolean not null, trusted boolean not null, version integer, created_date timestamp(6) with time zone, expires_in timestamp(6) with time zone, last_login_at timestamp(6) with time zone, last_refreshed_at timestamp(6) with time zone, refresh_count bigint, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, ip_address varchar(45), device_id varchar(100) not null, access_token_id varchar(255), created_by varchar(255), device_name varchar(255), refresh_token_id varchar(255), updated_by varchar(255), user_agent varchar(255), primary key (id), constraint uc_devicesession_user_id_device_id unique (user_id, device_id));
create table user_management.permission (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, name varchar(100) not null unique, created_by varchar(255), description varchar(255), updated_by varchar(255), primary key (id));
create table user_management.role (deleted boolean not null, is_default boolean, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, name varchar(50) not null unique, created_by varchar(255), description varchar(255), updated_by varchar(255), primary key (id));
create table user_management.user_profile (date_of_birth date, deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, phone varchar(15) unique, address_id uuid unique, id uuid not null, user_id uuid not null unique, full_name varchar(100) not null, avatar_url varchar(255), created_by varchar(255), updated_by varchar(255), primary key (id));
create table user_management.users (active boolean not null, deleted boolean not null, first_login boolean not null, locked boolean not null, mfa_enabled boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, username varchar(50) not null unique, created_by varchar(255), email varchar(255) unique, password varchar(255) not null, updated_by varchar(255), primary key (id), constraint idx_user_phone_unq unique (phone));
create index idx_devicesession_user_id on user_management.device_session (user_id);
create index idx_devicesession_device_id on user_management.device_session (device_id);
create index idx_userprofile_full_name on user_management.user_profile (full_name);
create table role_permissions (permissions_id uuid not null, role_id uuid not null, primary key (role_id, permissions_id));
create table users_roles (roles_id uuid not null, user_id uuid not null, primary key (roles_id, user_id));
alter table if exists appointment.appointment add constraint FK4apif2ewfyf14077ichee8g06 foreign key (patient_id) references patient.patient;
alter table if exists appointment.appointment add constraint FK2xk31jxbwpoobso94jdscytej foreign key (specialty_id) references medical_staff_management.specialty;
alter table if exists appointment.queue_ticket add constraint FKg0x1vvij9fdm7tvguubv61sgy foreign key (appointment_id) references appointment.appointment;
alter table if exists appointment.queue_ticket add constraint FKq40ac9eew03gdlnevyj5rdna2 foreign key (doctor_id) references medical_staff_management.staff;
alter table if exists appointment.queue_ticket add constraint FK6w6r44molpv2tl5ak1d9dl5mt foreign key (room_id) references organization.room;
alter table if exists appointment.queue_ticket add constraint FKav8oigrub7qod5n6da8kdi42r foreign key (examination_id) references examination.examination;
alter table if exists authentication.login_attempt add constraint FKocc7qiteno4e2mj9ww8fu6w6c foreign key (user_id) references user_management.users;
alter table if exists authentication.mfa_backup_code add constraint FK4gyfo4vgpnpfvsh64t31n7oqo foreign key (user_id) references user_management.users;
alter table if exists authentication.mfa_config add constraint FK3glxtej7nhswmb4f83bjnlgph foreign key (user_id) references user_management.users;
alter table if exists authentication.oauth_account add constraint FKfo0bd94g5i95ufayqbge39p2f foreign key (user_id) references user_management.users on delete cascade;
alter table if exists authentication.otp_challenge add constraint FKjntybiuc05f9f4y6xiy2f3ays foreign key (user_id) references user_management.users;
alter table if exists billing.invoice add constraint FKltqsckn6etx5w9cpcxhwgqhef foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists billing.invoice add constraint FKhbmd5jvpve5bo8blx5edcob4t foreign key (examination_id) references examination.examination;
alter table if exists billing.invoice add constraint FKooyykfsat84yeqr06yx3h5392 foreign key (patient_id) references patient.patient;
alter table if exists billing.invoice add constraint FK938ysly43px2i4fwfsp3vjbat foreign key (room_id) references organization.room;
alter table if exists billing.invoice_item add constraint FKbu6tmpd0mtgu9wrw5bj5uv09v foreign key (invoice_id) references billing.invoice;
alter table if exists common.address add constraint FKh8wc5qrs39wmsct8cg1fnd0cg foreign key (ward_id) references common.administrative_unit;
alter table if exists common.administrative_unit add constraint FKcd12wdp73q0vo69vsb49u50po foreign key (parent_id) references common.administrative_unit;
alter table if exists common.notification add constraint FKnk4ftb5am9ubmkv1661h15ds9 foreign key (user_id) references user_management.users;
alter table if exists content_management.content add constraint FKfrpvw5cl6uk0qlk9oobhjj4ok foreign key (author_id) references medical_staff_management.staff;
alter table if exists content_management.content_tag add constraint FKs7joyi8avvjnbkog3yx966mb5 foreign key (content_id) references content_management.content;
alter table if exists examination.diagnosis add constraint FKam2l2v2anxv27ab14dgvfvnvp foreign key (examination_id) references examination.examination;
alter table if exists examination.diagnosis add constraint FKbtrl1uxws2nfcd1a57ol2xo6d foreign key (icd_code_id) references common.icd_code;
alter table if exists examination.examination add constraint FKmn1l13u1iroqkv46h8dnxcmuw foreign key (patient_id) references patient.patient;
alter table if exists examination.examination add constraint FKdosuxmxbt8wp48ejfuqf3obrw foreign key (staff_id) references medical_staff_management.staff;
alter table if exists examination.prescription add constraint FKbp2uci5mr8jae2gxi0fsaeo9 foreign key (examination_id) references examination.examination;
alter table if exists examination.prescription_item add constraint FK8n60qtfk33xobnq41pbuqgdcm foreign key (medicine_id) references pharmacy.medicine;
alter table if exists examination.prescription_item add constraint FKeykn9e2g6nbmvwhqbrdm3jb2p foreign key (prescription_id) references examination.prescription;
alter table if exists examination.service_order add constraint FKe9bpv4yx0lvo17a0s4n9abaom foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists examination.service_order add constraint FKrr2sedo7ttrgthc8vwfi51f49 foreign key (examination_id) references examination.examination;
alter table if exists examination.service_order add constraint FKfmcxldtpbtnhwkl9ry5ex9poj foreign key (room_id) references organization.room;
alter table if exists examination.service_order_item add constraint FKrckasehfmti22mwideh2frhc foreign key (service_id) references examination.service_catalog;
alter table if exists examination.service_order_item add constraint FKa3mw659fei9nufwgfclf01r0t foreign key (service_order_id) references examination.service_order;
alter table if exists examination.vital_sign add constraint FKmvyj8fbuv55v2ku4hbgfjlqvp foreign key (examination_id) references examination.examination;
alter table if exists laboratory.lab_order add constraint FKigw1v0tbe2yj42umio3x3wwe0 foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists laboratory.lab_order add constraint FKr3qnaiuravkb9r78yteabiy3g foreign key (examination_id) references examination.examination;
alter table if exists laboratory.lab_order add constraint FK39tx4ti1irlt5totq8sd379ht foreign key (patient_id) references patient.patient;
alter table if exists laboratory.lab_order add constraint FKb58faixgv208y1vg20kh8btb3 foreign key (requested_by) references medical_staff_management.staff;
alter table if exists laboratory.lab_order add constraint FKiqmcaluukwk6n0sr70y011k6 foreign key (room_id) references organization.room;
alter table if exists laboratory.lab_test_result add constraint FKa0kdkrqxlqknp0yjfmjkgi1rv foreign key (lab_order_id) references laboratory.lab_order;
alter table if exists laboratory.lab_test_result add constraint FKhr48uweodmkv4xog5uxolsjwy foreign key (lab_test_id) references laboratory.lab_test;
alter table if exists laboratory.lab_test_result add constraint FKenyp8vtteop8aikfl7dpbcj9y foreign key (verified_by) references medical_staff_management.staff;
alter table if exists medical_staff_management.specialty add constraint FKlps74l72wvj96da9q5pnwyguk foreign key (department_id) references organization.department;
alter table if exists medical_staff_management.staff add constraint FK686rqn8cpu4ncey4odd8cw3hm foreign key (department_id) references organization.department;
alter table if exists medical_staff_management.staff add constraint FK97leb33cm0q32draq913xcxe1 foreign key (position_id) references medical_staff_management.position;
alter table if exists medical_staff_management.staff add constraint FKlltx599l1kpr1mo8e3tygglp4 foreign key (specialty_id) references medical_staff_management.specialty;
alter table if exists medical_staff_management.staff add constraint FKdlvw23ak3u9v9bomm8g12rtc0 foreign key (user_id) references user_management.users;
alter table if exists medical_staff_management.staff_schedule add constraint FKq4g0j5i832j2sng2r21x3wenk foreign key (room_id) references organization.room;
alter table if exists medical_staff_management.staff_schedule add constraint FKkc1jgvvbu2m5pwmi0njsx5a7u foreign key (staff_id) references medical_staff_management.staff;
alter table if exists medical_staff_management.staff_schedule_template add constraint FKobtflvnvhhti64qlgg0eq6mu5 foreign key (room_id) references organization.room;
alter table if exists medical_staff_management.staff_schedule_template add constraint FKni66a5abyy7d9lnmr7cmp8npj foreign key (staff_id) references medical_staff_management.staff;
alter table if exists organization.clinic add constraint FK15djxm3mj8bmp7mv7gdm6m1du foreign key (address_id) references common.address;
alter table if exists organization.department add constraint FK6io2v0mkg9sp6i0vgm9p1oem2 foreign key (clinic_id) references organization.clinic;
alter table if exists organization.room add constraint FKfbxs68qt7hfp6rkqan2eqbtyq foreign key (department_id) references organization.department;
alter table if exists patient.allergy add constraint FKg2ytn0t43rqrd6ag29e9hiowq foreign key (patient_id) references patient.patient;
alter table if exists patient.emergency_contact add constraint FK89nspxrjggthmmdr3o72n264x foreign key (patient_id) references patient.patient;
alter table if exists patient.medical_record add constraint FKbjbdpykbr7ea0c3fbnfxakw2h foreign key (examination_id) references examination.examination;
alter table if exists patient.medical_record add constraint FKt0lf3feuiurr73bpln2n6x0v foreign key (patient_id) references patient.patient;
alter table if exists patient.patient add constraint FKie6vajiyur53rjcl5nc2pe83t foreign key (user_id) references user_management.users;
alter table if exists pharmacy.dispense_record add constraint FKdy43lfntaxp6037at0rxvsaho foreign key (dispensed_by) references medical_staff_management.staff;
alter table if exists pharmacy.dispense_record add constraint FK94y7rabvmvq9wn2s4c1uwxc2q foreign key (patient_id) references patient.patient;
alter table if exists pharmacy.dispense_record add constraint FKf5ychtfp3ayur01j3y0gcr8kj foreign key (prescription_id) references examination.prescription;
alter table if exists pharmacy.dispense_record add constraint FKqod51e3jio2x3sa8chjl4soe4 foreign key (room_id) references organization.room;
alter table if exists user_management.device_session add constraint FKd5djcii31tjhvjnhj74vnsk85 foreign key (user_id) references user_management.users;
alter table if exists user_management.user_profile add constraint FKt7ck1erxe5phbhrdk1cn92h52 foreign key (address_id) references common.address;
alter table if exists user_management.user_profile add constraint FKuganfwvnbll4kn2a3jeyxtyi foreign key (user_id) references user_management.users;
alter table if exists role_permissions add constraint FKclluu29apreb6osx6ogt4qe16 foreign key (permissions_id) references user_management.permission;
alter table if exists role_permissions add constraint FKlodb7xh4a2xjv39gc3lsop95n foreign key (role_id) references user_management.role;
alter table if exists users_roles add constraint FK15d410tj6juko0sq9k4km60xq foreign key (roles_id) references user_management.role;
alter table if exists users_roles add constraint FK2o0jvgh89lemvvo17cbqvdxaa foreign key (user_id) references user_management.users;
create table appointment.appointment (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, specialty_id uuid not null, source varchar(30) check (source in ('SYSTEM','STAFF_CREATED','PATIENT_PORTAL','MOBILE_APP','WALK_IN')), status varchar(30) check (status in ('PENDING','CONFIRMED','CHECKED_IN','IN_PROGRESS','COMPLETED','CANCELLED','NO_SHOW')), type varchar(30) check (type in ('CONSULTATION','FOLLOW_UP','EMERGENCY','ONLINE')), created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table appointment.queue_ticket (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, queue_number varchar(10) not null, appointment_id uuid not null unique, doctor_id uuid not null, examination_id uuid unique, id uuid not null, room_id uuid not null, priority varchar(20) check (priority in ('NORMAL','HIGH')), status varchar(30) check (status in ('WAITING','CALLED','IN_SERVICE','IN_SERVICE_WAITING_RESULT','WAITING_AFTER_RESULT','SKIPPED','DONE','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table authentication.auth_token_blacklist (deleted boolean not null, version integer, created_date timestamp(6) with time zone, expires_at timestamp(6) with time zone, revoked_at timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, jti varchar(128) not null unique, created_by varchar(255), reason varchar(255), updated_by varchar(255), primary key (id));
create table authentication.login_attempt (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, status varchar(20) not null check (status in ('SUCCESS','MFA_PENDING','FAILURE','LOCKED')), ip_address varchar(45), created_by varchar(255), login_method varchar(255), updated_by varchar(255), user_agent varchar(255), primary key (id));
create table authentication.mfa_backup_code (deleted boolean not null, used boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, code_hash varchar(255) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table authentication.mfa_config (deleted boolean not null, is_primary boolean not null, revoked boolean not null, version integer, created_date timestamp(6) with time zone, last_verified_at timestamp(6) with time zone, sign_count bigint, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, mfa_type varchar(32) not null check (mfa_type in ('TOTP','SMS','EMAIL','PUSH_NOTIFICATION','PASSKEY','EMAIL_VERIFICATION')), aaguid varchar(100), credential_id varchar(200) unique, attestation_format varchar(255), contact varchar(255), created_by varchar(255), device_name varchar(255), secret varchar(255), updated_by varchar(255), public_key bytea, primary key (id));
create table authentication.oauth_account (deleted boolean not null, is_revoke boolean, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, provider varchar(20) not null check (provider in ('GOOGLE','FACEBOOK','GITHUB')), avatar_url varchar(500), created_by varchar(255), email varchar(255), name varchar(255), provider_user_id varchar(255) not null, updated_by varchar(255), primary key (id), constraint uc_oauthaccount_provider_user_id unique (provider, provider_user_id));
create table authentication.otp_challenge (attempt_count integer not null, deleted boolean not null, verified boolean not null, version integer, created_date timestamp(6) with time zone, expires_at timestamp(6) with time zone not null, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, mfa_type varchar(30) not null check (mfa_type in ('TOTP','SMS','EMAIL','PUSH_NOTIFICATION','PASSKEY','EMAIL_VERIFICATION')), code varchar(255) not null, created_by varchar(255), updated_by varchar(255), metadata jsonb, primary key (id));
create index idx_loginattempt_user_id on authentication.login_attempt (user_id);
create index idx_loginattempt_ip_address on authentication.login_attempt (ip_address);
create index idx_mfa_backup_code_user_id on authentication.mfa_backup_code (user_id);
create index idx_oauthaccount_user_id on authentication.oauth_account (user_id);
create index idx_oauthaccount_provider_user_id on authentication.oauth_account (provider_user_id);
create index idx_otpchallenge_user_id on authentication.otp_challenge (user_id);
create index idx_otpchallenge_mfa_type on authentication.otp_challenge (mfa_type);
create table billing.invoice (deleted boolean not null, paid boolean not null, total_amount numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, issue_date timestamp(6) not null, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid unique, id uuid not null, patient_id uuid not null, room_id uuid, invoice_number varchar(30) not null unique, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table billing.invoice_item (deleted boolean not null, quantity integer not null, total_price numeric(38,2) not null, unit_price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, invoice_id uuid not null, created_by varchar(255), description varchar(255) not null, updated_by varchar(255), primary key (id));
create table common.address (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, ward_id uuid, city_name varchar(255), created_by varchar(255), district_name varchar(255), street varchar(255), updated_by varchar(255), ward_name varchar(255), primary key (id));
create table common.administrative_unit (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, code varchar(10) not null unique, id uuid not null, parent_id uuid, level varchar(20) not null check (level in ('PROVINCE','DISTRICT','WARD')), name varchar(100) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table common.file_attachment (deleted boolean not null, version integer, created_date timestamp(6) with time zone, size bigint not null, updated_date timestamp(6) with time zone, id uuid not null, content_type varchar(255) not null, created_by varchar(255), entity_id varchar(255), entity_type varchar(255), file_name varchar(255) not null, updated_by varchar(255), upload_purpose varchar(255), url varchar(255) not null, primary key (id));
create table common.icd_code (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, code varchar(10) not null unique, id uuid not null, icd_version varchar(20), chapter varchar(100), created_by varchar(255), description TEXT, name varchar(255) not null, updated_by varchar(255), primary key (id));
create table common.notification (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, created_by varchar(255), message varchar(255), reference_id varchar(255), status varchar(255) check (status in ('READ','UNREAD')), title varchar(255) not null, topic varchar(255), type varchar(255) check (type in ('QUEUE_NEW','ORDER_NEW','LAB_ORDER_NEW','PAYMENT_NEW','APPOINTMENT_NEW')), updated_by varchar(255), primary key (id));
create table content_management.content (deleted boolean not null, version integer, created_date timestamp(6) with time zone, published_at timestamp(6) with time zone, updated_date timestamp(6) with time zone, author_id uuid not null, id uuid not null, status varchar(20) not null check (status in ('DRAFT','PUBLISHED','ARCHIVED')), title varchar(200) not null, slug varchar(220) not null unique, cover_image_url varchar(500), excerpt varchar(500), body jsonb not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table content_management.content_tag (content_id uuid not null, tag varchar(50) not null, primary key (content_id, tag));
create table examination.diagnosis (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null, icd_code_id uuid, id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.examination (deleted boolean not null, version integer, created_date timestamp(6) with time zone, examination_date timestamp(6) not null, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, staff_id uuid not null, status varchar(32) check (status in ('ONGOING','COMPLETED','CANCELLED')), type varchar(50) check (type in ('GENERAL','SPECIALIST','FOLLOW_UP','EMERGENCY')), created_by varchar(255), diagnosis_summary TEXT, symptom TEXT, updated_by varchar(255), primary key (id));
create table examination.prescription (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null unique, id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.prescription_item (deleted boolean not null, quantity integer, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, medicine_id uuid not null, prescription_id uuid not null, dosage varchar(50), duration varchar(50), frequency varchar(50), created_by varchar(255), instruction TEXT, updated_by varchar(255), primary key (id));
create table examination.service_catalog (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(20) not null unique, room_type varchar(50) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), category varchar(500), name varchar(500) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table examination.service_order (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid not null, id uuid not null, room_id uuid, order_code varchar(20) not null unique, status varchar(30) check (status in ('PENDING','READY','IN_PROGRESS','COMPLETED','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table examination.service_order_item (deleted boolean not null, price numeric(38,2), version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, service_id uuid not null, service_order_id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.vital_sign (deleted boolean not null, height float(53), pulse integer, respiration_rate integer, temperature float(53), version integer, weight float(53), created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null, id uuid not null, blood_pressure varchar(20), created_by varchar(255), updated_by varchar(255), primary key (id));
create table laboratory.lab_order (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid, id uuid not null, patient_id uuid not null, requested_by uuid not null, room_id uuid, order_code varchar(30) not null unique, status varchar(30) check (status in ('PENDING','IN_PROGRESS','COMPLETED','VERIFIED','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table laboratory.lab_test (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(20) not null unique, unit varchar(50), name varchar(150) not null, reference_range varchar(300), category varchar(500), created_by varchar(255), description TEXT, room_type varchar(255) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), updated_by varchar(255), primary key (id));
create table laboratory.lab_test_result (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, verified_at timestamp(6), id uuid not null, lab_order_id uuid not null, lab_test_id uuid not null, verified_by uuid, status varchar(30) check (status in ('PENDING','IN_PROGRESS','COMPLETED','VERIFIED','CANCELLED')), unit varchar(50), result_value varchar(100), reference_range varchar(500), created_by varchar(255), remark TEXT, updated_by varchar(255), primary key (id));
create table medical_staff_management.position (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, position_code varchar(20) not null unique, title varchar(100) not null unique, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table medical_staff_management.specialty (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, created_by varchar(255), description varchar(255), name varchar(255) not null, updated_by varchar(255), primary key (id));
create table medical_staff_management.staff (deleted boolean not null, experience_years integer, joined_date date, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, position_id uuid, specialty_id uuid, user_id uuid not null unique, staff_type varchar(32) check (staff_type in ('DOCTOR','NURSE','TECHNICIAN','LAB_TECHNICIAN','PHARMACIST','RECEPTIONIST','CASHIER','MANAGER','SYSTEM_ADMIN')), bio TEXT, created_by varchar(255), education varchar(255), email varchar(255) unique, full_name varchar(255), license_number varchar(255), phone varchar(255) unique, updated_by varchar(255), primary key (id));
create table medical_staff_management.staff_schedule (date date not null, deleted boolean not null, end_time time(6) not null, start_time time(6) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, room_id uuid not null, staff_id uuid not null, note varchar(500), created_by varchar(255), status varchar(255) not null check (status in ('AVAILABLE','OFF','CANCELLED','CHANGED')), updated_by varchar(255), primary key (id), constraint uk_staff_date_room_time unique (staff_id, date, room_id, start_time, end_time));
create table medical_staff_management.staff_schedule_template (active boolean not null, deleted boolean not null, end_time time(6) not null, start_time time(6) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, room_id uuid not null, staff_id uuid not null, created_by varchar(255), day_of_week varchar(255) not null check (day_of_week in ('MONDAY','TUESDAY','WEDNESDAY','THURSDAY','FRIDAY','SATURDAY','SUNDAY')), updated_by varchar(255), primary key (id));
create table organization.clinic (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, address_id uuid unique, id uuid not null, phone varchar(20), account_number varchar(50), tax_code varchar(50), email varchar(100), bank_name varchar(150), name varchar(150) not null unique, website varchar(150), created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table organization.department (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, clinic_id uuid not null, id uuid not null, name varchar(100) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table organization.room (capacity integer, deleted boolean not null, floor_number integer, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, room_type varchar(50) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), name varchar(100) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table patient.allergy (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, severity varchar(50), substance varchar(100) not null, created_by varchar(255), reaction TEXT, updated_by varchar(255), primary key (id));
create table patient.emergency_contact (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, phone varchar(20) not null, relationship varchar(50), full_name varchar(150) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table patient.medical_record (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid unique, id uuid not null, patient_id uuid not null, record_code varchar(20) not null unique, created_by varchar(255), diagnosis TEXT, treatment TEXT, updated_by varchar(255), primary key (id));
create table patient.patient (date_of_birth date, deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, gender varchar(10) check (gender in ('MALE','FEMALE','OTHER')), id uuid not null, user_id uuid not null unique, blood_type varchar(20) check (blood_type in ('A_POSITIVE','A_NEGATIVE','B_POSITIVE','B_NEGATIVE','AB_POSITIVE','AB_NEGATIVE','O_POSITIVE','O_NEGATIVE')), insurance_number varchar(20), patient_code varchar(20) not null unique, phone varchar(20), status varchar(20) check (status in ('ACTIVE','INACTIVE','DECEASED','TRANSFERRED')), email varchar(100), full_name varchar(150) not null, address varchar(255), created_by varchar(255), init_password varchar(255), updated_by varchar(255), primary key (id));
create table pharmacy.dispense_record (deleted boolean not null, total_cost numeric(38,2), version integer, created_date timestamp(6) with time zone, dispensed_at timestamp(6), updated_date timestamp(6) with time zone, dispensed_by uuid, id uuid not null, patient_id uuid not null, prescription_id uuid not null unique, room_id uuid, status varchar(30) check (status in ('PENDING','DISPENSED','CANCELLED')), created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table pharmacy.medicine (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(30) not null unique, unit varchar(30), strength varchar(50), dosage_form varchar(100), name varchar(100) not null, active_ingredient varchar(500), created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table user_management.device_session (deleted boolean not null, remember_me boolean not null, revoked boolean not null, trusted boolean not null, version integer, created_date timestamp(6) with time zone, expires_in timestamp(6) with time zone, last_login_at timestamp(6) with time zone, last_refreshed_at timestamp(6) with time zone, refresh_count bigint, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, ip_address varchar(45), device_id varchar(100) not null, access_token_id varchar(255), created_by varchar(255), device_name varchar(255), refresh_token_id varchar(255), updated_by varchar(255), user_agent varchar(255), primary key (id), constraint uc_devicesession_user_id_device_id unique (user_id, device_id));
create table user_management.permission (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, name varchar(100) not null unique, created_by varchar(255), description varchar(255), updated_by varchar(255), primary key (id));
create table user_management.role (deleted boolean not null, is_default boolean, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, name varchar(50) not null unique, created_by varchar(255), description varchar(255), updated_by varchar(255), primary key (id));
create table user_management.user_profile (date_of_birth date, deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, phone varchar(15) unique, address_id uuid unique, id uuid not null, user_id uuid not null unique, full_name varchar(100) not null, avatar_url varchar(255), created_by varchar(255), updated_by varchar(255), primary key (id));
create table user_management.users (active boolean not null, deleted boolean not null, first_login boolean not null, locked boolean not null, mfa_enabled boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, username varchar(50) not null unique, created_by varchar(255), email varchar(255) unique, password varchar(255) not null, updated_by varchar(255), primary key (id), constraint idx_user_phone_unq unique (phone));
create index idx_devicesession_user_id on user_management.device_session (user_id);
create index idx_devicesession_device_id on user_management.device_session (device_id);
create index idx_userprofile_full_name on user_management.user_profile (full_name);
create table role_permissions (permissions_id uuid not null, role_id uuid not null, primary key (role_id, permissions_id));
create table users_roles (roles_id uuid not null, user_id uuid not null, primary key (roles_id, user_id));
alter table if exists appointment.appointment add constraint FK4apif2ewfyf14077ichee8g06 foreign key (patient_id) references patient.patient;
alter table if exists appointment.appointment add constraint FK2xk31jxbwpoobso94jdscytej foreign key (specialty_id) references medical_staff_management.specialty;
alter table if exists appointment.queue_ticket add constraint FKg0x1vvij9fdm7tvguubv61sgy foreign key (appointment_id) references appointment.appointment;
alter table if exists appointment.queue_ticket add constraint FKq40ac9eew03gdlnevyj5rdna2 foreign key (doctor_id) references medical_staff_management.staff;
alter table if exists appointment.queue_ticket add constraint FK6w6r44molpv2tl5ak1d9dl5mt foreign key (room_id) references organization.room;
alter table if exists appointment.queue_ticket add constraint FKav8oigrub7qod5n6da8kdi42r foreign key (examination_id) references examination.examination;
alter table if exists authentication.login_attempt add constraint FKocc7qiteno4e2mj9ww8fu6w6c foreign key (user_id) references user_management.users;
alter table if exists authentication.mfa_backup_code add constraint FK4gyfo4vgpnpfvsh64t31n7oqo foreign key (user_id) references user_management.users;
alter table if exists authentication.mfa_config add constraint FK3glxtej7nhswmb4f83bjnlgph foreign key (user_id) references user_management.users;
alter table if exists authentication.oauth_account add constraint FKfo0bd94g5i95ufayqbge39p2f foreign key (user_id) references user_management.users on delete cascade;
alter table if exists authentication.otp_challenge add constraint FKjntybiuc05f9f4y6xiy2f3ays foreign key (user_id) references user_management.users;
alter table if exists billing.invoice add constraint FKltqsckn6etx5w9cpcxhwgqhef foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists billing.invoice add constraint FKhbmd5jvpve5bo8blx5edcob4t foreign key (examination_id) references examination.examination;
alter table if exists billing.invoice add constraint FKooyykfsat84yeqr06yx3h5392 foreign key (patient_id) references patient.patient;
alter table if exists billing.invoice add constraint FK938ysly43px2i4fwfsp3vjbat foreign key (room_id) references organization.room;
alter table if exists billing.invoice_item add constraint FKbu6tmpd0mtgu9wrw5bj5uv09v foreign key (invoice_id) references billing.invoice;
alter table if exists common.address add constraint FKh8wc5qrs39wmsct8cg1fnd0cg foreign key (ward_id) references common.administrative_unit;
alter table if exists common.administrative_unit add constraint FKcd12wdp73q0vo69vsb49u50po foreign key (parent_id) references common.administrative_unit;
alter table if exists common.notification add constraint FKnk4ftb5am9ubmkv1661h15ds9 foreign key (user_id) references user_management.users;
alter table if exists content_management.content add constraint FKfrpvw5cl6uk0qlk9oobhjj4ok foreign key (author_id) references medical_staff_management.staff;
alter table if exists content_management.content_tag add constraint FKs7joyi8avvjnbkog3yx966mb5 foreign key (content_id) references content_management.content;
alter table if exists examination.diagnosis add constraint FKam2l2v2anxv27ab14dgvfvnvp foreign key (examination_id) references examination.examination;
alter table if exists examination.diagnosis add constraint FKbtrl1uxws2nfcd1a57ol2xo6d foreign key (icd_code_id) references common.icd_code;
alter table if exists examination.examination add constraint FKmn1l13u1iroqkv46h8dnxcmuw foreign key (patient_id) references patient.patient;
alter table if exists examination.examination add constraint FKdosuxmxbt8wp48ejfuqf3obrw foreign key (staff_id) references medical_staff_management.staff;
alter table if exists examination.prescription add constraint FKbp2uci5mr8jae2gxi0fsaeo9 foreign key (examination_id) references examination.examination;
alter table if exists examination.prescription_item add constraint FK8n60qtfk33xobnq41pbuqgdcm foreign key (medicine_id) references pharmacy.medicine;
alter table if exists examination.prescription_item add constraint FKeykn9e2g6nbmvwhqbrdm3jb2p foreign key (prescription_id) references examination.prescription;
alter table if exists examination.service_order add constraint FKe9bpv4yx0lvo17a0s4n9abaom foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists examination.service_order add constraint FKrr2sedo7ttrgthc8vwfi51f49 foreign key (examination_id) references examination.examination;
alter table if exists examination.service_order add constraint FKfmcxldtpbtnhwkl9ry5ex9poj foreign key (room_id) references organization.room;
alter table if exists examination.service_order_item add constraint FKrckasehfmti22mwideh2frhc foreign key (service_id) references examination.service_catalog;
alter table if exists examination.service_order_item add constraint FKa3mw659fei9nufwgfclf01r0t foreign key (service_order_id) references examination.service_order;
alter table if exists examination.vital_sign add constraint FKmvyj8fbuv55v2ku4hbgfjlqvp foreign key (examination_id) references examination.examination;
alter table if exists laboratory.lab_order add constraint FKigw1v0tbe2yj42umio3x3wwe0 foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists laboratory.lab_order add constraint FKr3qnaiuravkb9r78yteabiy3g foreign key (examination_id) references examination.examination;
alter table if exists laboratory.lab_order add constraint FK39tx4ti1irlt5totq8sd379ht foreign key (patient_id) references patient.patient;
alter table if exists laboratory.lab_order add constraint FKb58faixgv208y1vg20kh8btb3 foreign key (requested_by) references medical_staff_management.staff;
alter table if exists laboratory.lab_order add constraint FKiqmcaluukwk6n0sr70y011k6 foreign key (room_id) references organization.room;
alter table if exists laboratory.lab_test_result add constraint FKa0kdkrqxlqknp0yjfmjkgi1rv foreign key (lab_order_id) references laboratory.lab_order;
alter table if exists laboratory.lab_test_result add constraint FKhr48uweodmkv4xog5uxolsjwy foreign key (lab_test_id) references laboratory.lab_test;
alter table if exists laboratory.lab_test_result add constraint FKenyp8vtteop8aikfl7dpbcj9y foreign key (verified_by) references medical_staff_management.staff;
alter table if exists medical_staff_management.specialty add constraint FKlps74l72wvj96da9q5pnwyguk foreign key (department_id) references organization.department;
alter table if exists medical_staff_management.staff add constraint FK686rqn8cpu4ncey4odd8cw3hm foreign key (department_id) references organization.department;
alter table if exists medical_staff_management.staff add constraint FK97leb33cm0q32draq913xcxe1 foreign key (position_id) references medical_staff_management.position;
alter table if exists medical_staff_management.staff add constraint FKlltx599l1kpr1mo8e3tygglp4 foreign key (specialty_id) references medical_staff_management.specialty;
alter table if exists medical_staff_management.staff add constraint FKdlvw23ak3u9v9bomm8g12rtc0 foreign key (user_id) references user_management.users;
alter table if exists medical_staff_management.staff_schedule add constraint FKq4g0j5i832j2sng2r21x3wenk foreign key (room_id) references organization.room;
alter table if exists medical_staff_management.staff_schedule add constraint FKkc1jgvvbu2m5pwmi0njsx5a7u foreign key (staff_id) references medical_staff_management.staff;
alter table if exists medical_staff_management.staff_schedule_template add constraint FKobtflvnvhhti64qlgg0eq6mu5 foreign key (room_id) references organization.room;
alter table if exists medical_staff_management.staff_schedule_template add constraint FKni66a5abyy7d9lnmr7cmp8npj foreign key (staff_id) references medical_staff_management.staff;
alter table if exists organization.clinic add constraint FK15djxm3mj8bmp7mv7gdm6m1du foreign key (address_id) references common.address;
alter table if exists organization.department add constraint FK6io2v0mkg9sp6i0vgm9p1oem2 foreign key (clinic_id) references organization.clinic;
alter table if exists organization.room add constraint FKfbxs68qt7hfp6rkqan2eqbtyq foreign key (department_id) references organization.department;
alter table if exists patient.allergy add constraint FKg2ytn0t43rqrd6ag29e9hiowq foreign key (patient_id) references patient.patient;
alter table if exists patient.emergency_contact add constraint FK89nspxrjggthmmdr3o72n264x foreign key (patient_id) references patient.patient;
alter table if exists patient.medical_record add constraint FKbjbdpykbr7ea0c3fbnfxakw2h foreign key (examination_id) references examination.examination;
alter table if exists patient.medical_record add constraint FKt0lf3feuiurr73bpln2n6x0v foreign key (patient_id) references patient.patient;
alter table if exists patient.patient add constraint FKie6vajiyur53rjcl5nc2pe83t foreign key (user_id) references user_management.users;
alter table if exists pharmacy.dispense_record add constraint FKdy43lfntaxp6037at0rxvsaho foreign key (dispensed_by) references medical_staff_management.staff;
alter table if exists pharmacy.dispense_record add constraint FK94y7rabvmvq9wn2s4c1uwxc2q foreign key (patient_id) references patient.patient;
alter table if exists pharmacy.dispense_record add constraint FKf5ychtfp3ayur01j3y0gcr8kj foreign key (prescription_id) references examination.prescription;
alter table if exists pharmacy.dispense_record add constraint FKqod51e3jio2x3sa8chjl4soe4 foreign key (room_id) references organization.room;
alter table if exists user_management.device_session add constraint FKd5djcii31tjhvjnhj74vnsk85 foreign key (user_id) references user_management.users;
alter table if exists user_management.user_profile add constraint FKt7ck1erxe5phbhrdk1cn92h52 foreign key (address_id) references common.address;
alter table if exists user_management.user_profile add constraint FKuganfwvnbll4kn2a3jeyxtyi foreign key (user_id) references user_management.users;
alter table if exists role_permissions add constraint FKclluu29apreb6osx6ogt4qe16 foreign key (permissions_id) references user_management.permission;
alter table if exists role_permissions add constraint FKlodb7xh4a2xjv39gc3lsop95n foreign key (role_id) references user_management.role;
alter table if exists users_roles add constraint FK15d410tj6juko0sq9k4km60xq foreign key (roles_id) references user_management.role;
alter table if exists users_roles add constraint FK2o0jvgh89lemvvo17cbqvdxaa foreign key (user_id) references user_management.users;
create table appointment.appointment (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, specialty_id uuid not null, source varchar(30) check (source in ('SYSTEM','STAFF_CREATED','PATIENT_PORTAL','MOBILE_APP','WALK_IN')), status varchar(30) check (status in ('PENDING','CONFIRMED','CHECKED_IN','IN_PROGRESS','COMPLETED','CANCELLED','NO_SHOW')), type varchar(30) check (type in ('CONSULTATION','FOLLOW_UP','EMERGENCY','ONLINE')), created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table appointment.queue_ticket (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, queue_number varchar(10) not null, appointment_id uuid not null unique, doctor_id uuid not null, examination_id uuid unique, id uuid not null, room_id uuid not null, priority varchar(20) check (priority in ('NORMAL','HIGH')), status varchar(30) check (status in ('WAITING','CALLED','IN_SERVICE','IN_SERVICE_WAITING_RESULT','WAITING_AFTER_RESULT','SKIPPED','DONE','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table authentication.auth_token_blacklist (deleted boolean not null, version integer, created_date timestamp(6) with time zone, expires_at timestamp(6) with time zone, revoked_at timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, jti varchar(128) not null unique, created_by varchar(255), reason varchar(255), updated_by varchar(255), primary key (id));
create table authentication.login_attempt (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, status varchar(20) not null check (status in ('SUCCESS','MFA_PENDING','FAILURE','LOCKED')), ip_address varchar(45), created_by varchar(255), login_method varchar(255), updated_by varchar(255), user_agent varchar(255), primary key (id));
create table authentication.mfa_backup_code (deleted boolean not null, used boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, code_hash varchar(255) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table authentication.mfa_config (deleted boolean not null, is_primary boolean not null, revoked boolean not null, version integer, created_date timestamp(6) with time zone, last_verified_at timestamp(6) with time zone, sign_count bigint, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, mfa_type varchar(32) not null check (mfa_type in ('TOTP','SMS','EMAIL','PUSH_NOTIFICATION','PASSKEY','EMAIL_VERIFICATION')), aaguid varchar(100), credential_id varchar(200) unique, attestation_format varchar(255), contact varchar(255), created_by varchar(255), device_name varchar(255), secret varchar(255), updated_by varchar(255), public_key bytea, primary key (id));
create table authentication.oauth_account (deleted boolean not null, is_revoke boolean, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, provider varchar(20) not null check (provider in ('GOOGLE','FACEBOOK','GITHUB')), avatar_url varchar(500), created_by varchar(255), email varchar(255), name varchar(255), provider_user_id varchar(255) not null, updated_by varchar(255), primary key (id), constraint uc_oauthaccount_provider_user_id unique (provider, provider_user_id));
create table authentication.otp_challenge (attempt_count integer not null, deleted boolean not null, verified boolean not null, version integer, created_date timestamp(6) with time zone, expires_at timestamp(6) with time zone not null, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, mfa_type varchar(30) not null check (mfa_type in ('TOTP','SMS','EMAIL','PUSH_NOTIFICATION','PASSKEY','EMAIL_VERIFICATION')), code varchar(255) not null, created_by varchar(255), updated_by varchar(255), metadata jsonb, primary key (id));
create index idx_loginattempt_user_id on authentication.login_attempt (user_id);
create index idx_loginattempt_ip_address on authentication.login_attempt (ip_address);
create index idx_mfa_backup_code_user_id on authentication.mfa_backup_code (user_id);
create index idx_oauthaccount_user_id on authentication.oauth_account (user_id);
create index idx_oauthaccount_provider_user_id on authentication.oauth_account (provider_user_id);
create index idx_otpchallenge_user_id on authentication.otp_challenge (user_id);
create index idx_otpchallenge_mfa_type on authentication.otp_challenge (mfa_type);
create table billing.invoice (deleted boolean not null, paid boolean not null, total_amount numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, issue_date timestamp(6) not null, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid unique, id uuid not null, patient_id uuid not null, room_id uuid, invoice_number varchar(30) not null unique, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table billing.invoice_item (deleted boolean not null, quantity integer not null, total_price numeric(38,2) not null, unit_price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, invoice_id uuid not null, created_by varchar(255), description varchar(255) not null, updated_by varchar(255), primary key (id));
create table common.address (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, ward_id uuid, city_name varchar(255), created_by varchar(255), district_name varchar(255), street varchar(255), updated_by varchar(255), ward_name varchar(255), primary key (id));
create table common.administrative_unit (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, code varchar(10) not null unique, id uuid not null, parent_id uuid, level varchar(20) not null check (level in ('PROVINCE','DISTRICT','WARD')), name varchar(100) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table common.file_attachment (deleted boolean not null, version integer, created_date timestamp(6) with time zone, size bigint not null, updated_date timestamp(6) with time zone, id uuid not null, content_type varchar(255) not null, created_by varchar(255), entity_id varchar(255), entity_type varchar(255), file_name varchar(255) not null, updated_by varchar(255), upload_purpose varchar(255), url varchar(255) not null, primary key (id));
create table common.icd_code (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, code varchar(10) not null unique, id uuid not null, icd_version varchar(20), chapter varchar(100), created_by varchar(255), description TEXT, name varchar(255) not null, updated_by varchar(255), primary key (id));
create table common.notification (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, created_by varchar(255), message varchar(255), reference_id varchar(255), status varchar(255) check (status in ('READ','UNREAD')), title varchar(255) not null, topic varchar(255), type varchar(255) check (type in ('QUEUE_NEW','ORDER_NEW','LAB_ORDER_NEW','PAYMENT_NEW','APPOINTMENT_NEW')), updated_by varchar(255), primary key (id));
create table content_management.content (deleted boolean not null, version integer, created_date timestamp(6) with time zone, published_at timestamp(6) with time zone, updated_date timestamp(6) with time zone, author_id uuid not null, id uuid not null, status varchar(20) not null check (status in ('DRAFT','PUBLISHED','ARCHIVED')), title varchar(200) not null, slug varchar(220) not null unique, cover_image_url varchar(500), excerpt varchar(500), body jsonb not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table content_management.content_tag (content_id uuid not null, tag varchar(50) not null, primary key (content_id, tag));
create table examination.diagnosis (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null, icd_code_id uuid, id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.examination (deleted boolean not null, version integer, created_date timestamp(6) with time zone, examination_date timestamp(6) not null, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, staff_id uuid not null, status varchar(32) check (status in ('ONGOING','COMPLETED','CANCELLED')), type varchar(50) check (type in ('GENERAL','SPECIALIST','FOLLOW_UP','EMERGENCY')), created_by varchar(255), diagnosis_summary TEXT, symptom TEXT, updated_by varchar(255), primary key (id));
create table examination.prescription (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null unique, id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.prescription_item (deleted boolean not null, quantity integer, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, medicine_id uuid not null, prescription_id uuid not null, dosage varchar(50), duration varchar(50), frequency varchar(50), created_by varchar(255), instruction TEXT, updated_by varchar(255), primary key (id));
create table examination.service_catalog (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(20) not null unique, room_type varchar(50) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), category varchar(500), name varchar(500) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table examination.service_order (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid not null, id uuid not null, room_id uuid, order_code varchar(20) not null unique, status varchar(30) check (status in ('PENDING','READY','IN_PROGRESS','COMPLETED','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table examination.service_order_item (deleted boolean not null, price numeric(38,2), version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, service_id uuid not null, service_order_id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.vital_sign (deleted boolean not null, height float(53), pulse integer, respiration_rate integer, temperature float(53), version integer, weight float(53), created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null, id uuid not null, blood_pressure varchar(20), created_by varchar(255), updated_by varchar(255), primary key (id));
create table laboratory.lab_order (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid, id uuid not null, patient_id uuid not null, requested_by uuid not null, room_id uuid, order_code varchar(30) not null unique, status varchar(30) check (status in ('PENDING','IN_PROGRESS','COMPLETED','VERIFIED','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table laboratory.lab_test (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(20) not null unique, unit varchar(50), name varchar(150) not null, reference_range varchar(300), category varchar(500), created_by varchar(255), description TEXT, room_type varchar(255) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), updated_by varchar(255), primary key (id));
create table laboratory.lab_test_result (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, verified_at timestamp(6), id uuid not null, lab_order_id uuid not null, lab_test_id uuid not null, verified_by uuid, status varchar(30) check (status in ('PENDING','IN_PROGRESS','COMPLETED','VERIFIED','CANCELLED')), unit varchar(50), result_value varchar(100), reference_range varchar(500), created_by varchar(255), remark TEXT, updated_by varchar(255), primary key (id));
create table medical_staff_management.position (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, position_code varchar(20) not null unique, title varchar(100) not null unique, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table medical_staff_management.specialty (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, created_by varchar(255), description varchar(255), name varchar(255) not null, updated_by varchar(255), primary key (id));
create table medical_staff_management.staff (deleted boolean not null, experience_years integer, joined_date date, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, position_id uuid, specialty_id uuid, user_id uuid not null unique, staff_type varchar(32) check (staff_type in ('DOCTOR','NURSE','TECHNICIAN','LAB_TECHNICIAN','PHARMACIST','RECEPTIONIST','CASHIER','MANAGER','SYSTEM_ADMIN')), bio TEXT, created_by varchar(255), education varchar(255), email varchar(255) unique, full_name varchar(255), license_number varchar(255), phone varchar(255) unique, updated_by varchar(255), primary key (id));
create table medical_staff_management.staff_schedule (date date not null, deleted boolean not null, end_time time(6) not null, start_time time(6) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, room_id uuid not null, staff_id uuid not null, note varchar(500), created_by varchar(255), status varchar(255) not null check (status in ('AVAILABLE','OFF','CANCELLED','CHANGED')), updated_by varchar(255), primary key (id), constraint uk_staff_date_room_time unique (staff_id, date, room_id, start_time, end_time));
create table medical_staff_management.staff_schedule_template (active boolean not null, deleted boolean not null, end_time time(6) not null, start_time time(6) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, room_id uuid not null, staff_id uuid not null, created_by varchar(255), day_of_week varchar(255) not null check (day_of_week in ('MONDAY','TUESDAY','WEDNESDAY','THURSDAY','FRIDAY','SATURDAY','SUNDAY')), updated_by varchar(255), primary key (id));
create table organization.clinic (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, address_id uuid unique, id uuid not null, phone varchar(20), account_number varchar(50), tax_code varchar(50), email varchar(100), bank_name varchar(150), name varchar(150) not null unique, website varchar(150), created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table organization.department (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, clinic_id uuid not null, id uuid not null, name varchar(100) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table organization.room (capacity integer, deleted boolean not null, floor_number integer, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, room_type varchar(50) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), name varchar(100) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table patient.allergy (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, severity varchar(50), substance varchar(100) not null, created_by varchar(255), reaction TEXT, updated_by varchar(255), primary key (id));
create table patient.emergency_contact (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, phone varchar(20) not null, relationship varchar(50), full_name varchar(150) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table patient.medical_record (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid unique, id uuid not null, patient_id uuid not null, record_code varchar(20) not null unique, created_by varchar(255), diagnosis TEXT, treatment TEXT, updated_by varchar(255), primary key (id));
create table patient.patient (date_of_birth date, deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, gender varchar(10) check (gender in ('MALE','FEMALE','OTHER')), id uuid not null, user_id uuid not null unique, blood_type varchar(20) check (blood_type in ('A_POSITIVE','A_NEGATIVE','B_POSITIVE','B_NEGATIVE','AB_POSITIVE','AB_NEGATIVE','O_POSITIVE','O_NEGATIVE')), insurance_number varchar(20), patient_code varchar(20) not null unique, phone varchar(20), status varchar(20) check (status in ('ACTIVE','INACTIVE','DECEASED','TRANSFERRED')), email varchar(100), full_name varchar(150) not null, address varchar(255), created_by varchar(255), init_password varchar(255), updated_by varchar(255), primary key (id));
create table pharmacy.dispense_record (deleted boolean not null, total_cost numeric(38,2), version integer, created_date timestamp(6) with time zone, dispensed_at timestamp(6), updated_date timestamp(6) with time zone, dispensed_by uuid, id uuid not null, patient_id uuid not null, prescription_id uuid not null unique, room_id uuid, status varchar(30) check (status in ('PENDING','DISPENSED','CANCELLED')), created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table pharmacy.medicine (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(30) not null unique, unit varchar(30), strength varchar(50), dosage_form varchar(100), name varchar(100) not null, active_ingredient varchar(500), created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table user_management.device_session (deleted boolean not null, remember_me boolean not null, revoked boolean not null, trusted boolean not null, version integer, created_date timestamp(6) with time zone, expires_in timestamp(6) with time zone, last_login_at timestamp(6) with time zone, last_refreshed_at timestamp(6) with time zone, refresh_count bigint, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, ip_address varchar(45), device_id varchar(100) not null, access_token_id varchar(255), created_by varchar(255), device_name varchar(255), refresh_token_id varchar(255), updated_by varchar(255), user_agent varchar(255), primary key (id), constraint uc_devicesession_user_id_device_id unique (user_id, device_id));
create table user_management.permission (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, name varchar(100) not null unique, created_by varchar(255), description varchar(255), updated_by varchar(255), primary key (id));
create table user_management.role (deleted boolean not null, is_default boolean, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, name varchar(50) not null unique, created_by varchar(255), description varchar(255), updated_by varchar(255), primary key (id));
create table user_management.user_profile (date_of_birth date, deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, phone varchar(15) unique, address_id uuid unique, id uuid not null, user_id uuid not null unique, full_name varchar(100) not null, avatar_url varchar(255), created_by varchar(255), updated_by varchar(255), primary key (id));
create table user_management.users (active boolean not null, deleted boolean not null, first_login boolean not null, locked boolean not null, mfa_enabled boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, username varchar(50) not null unique, created_by varchar(255), email varchar(255) unique, password varchar(255) not null, updated_by varchar(255), primary key (id), constraint idx_user_phone_unq unique (phone));
create index idx_devicesession_user_id on user_management.device_session (user_id);
create index idx_devicesession_device_id on user_management.device_session (device_id);
create index idx_userprofile_full_name on user_management.user_profile (full_name);
create table role_permissions (permissions_id uuid not null, role_id uuid not null, primary key (role_id, permissions_id));
create table users_roles (roles_id uuid not null, user_id uuid not null, primary key (roles_id, user_id));
alter table if exists appointment.appointment add constraint FK4apif2ewfyf14077ichee8g06 foreign key (patient_id) references patient.patient;
alter table if exists appointment.appointment add constraint FK2xk31jxbwpoobso94jdscytej foreign key (specialty_id) references medical_staff_management.specialty;
alter table if exists appointment.queue_ticket add constraint FKg0x1vvij9fdm7tvguubv61sgy foreign key (appointment_id) references appointment.appointment;
alter table if exists appointment.queue_ticket add constraint FKq40ac9eew03gdlnevyj5rdna2 foreign key (doctor_id) references medical_staff_management.staff;
alter table if exists appointment.queue_ticket add constraint FK6w6r44molpv2tl5ak1d9dl5mt foreign key (room_id) references organization.room;
alter table if exists appointment.queue_ticket add constraint FKav8oigrub7qod5n6da8kdi42r foreign key (examination_id) references examination.examination;
alter table if exists authentication.login_attempt add constraint FKocc7qiteno4e2mj9ww8fu6w6c foreign key (user_id) references user_management.users;
alter table if exists authentication.mfa_backup_code add constraint FK4gyfo4vgpnpfvsh64t31n7oqo foreign key (user_id) references user_management.users;
alter table if exists authentication.mfa_config add constraint FK3glxtej7nhswmb4f83bjnlgph foreign key (user_id) references user_management.users;
alter table if exists authentication.oauth_account add constraint FKfo0bd94g5i95ufayqbge39p2f foreign key (user_id) references user_management.users on delete cascade;
alter table if exists authentication.otp_challenge add constraint FKjntybiuc05f9f4y6xiy2f3ays foreign key (user_id) references user_management.users;
alter table if exists billing.invoice add constraint FKltqsckn6etx5w9cpcxhwgqhef foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists billing.invoice add constraint FKhbmd5jvpve5bo8blx5edcob4t foreign key (examination_id) references examination.examination;
alter table if exists billing.invoice add constraint FKooyykfsat84yeqr06yx3h5392 foreign key (patient_id) references patient.patient;
alter table if exists billing.invoice add constraint FK938ysly43px2i4fwfsp3vjbat foreign key (room_id) references organization.room;
alter table if exists billing.invoice_item add constraint FKbu6tmpd0mtgu9wrw5bj5uv09v foreign key (invoice_id) references billing.invoice;
alter table if exists common.address add constraint FKh8wc5qrs39wmsct8cg1fnd0cg foreign key (ward_id) references common.administrative_unit;
alter table if exists common.administrative_unit add constraint FKcd12wdp73q0vo69vsb49u50po foreign key (parent_id) references common.administrative_unit;
alter table if exists common.notification add constraint FKnk4ftb5am9ubmkv1661h15ds9 foreign key (user_id) references user_management.users;
alter table if exists content_management.content add constraint FKfrpvw5cl6uk0qlk9oobhjj4ok foreign key (author_id) references medical_staff_management.staff;
alter table if exists content_management.content_tag add constraint FKs7joyi8avvjnbkog3yx966mb5 foreign key (content_id) references content_management.content;
alter table if exists examination.diagnosis add constraint FKam2l2v2anxv27ab14dgvfvnvp foreign key (examination_id) references examination.examination;
alter table if exists examination.diagnosis add constraint FKbtrl1uxws2nfcd1a57ol2xo6d foreign key (icd_code_id) references common.icd_code;
alter table if exists examination.examination add constraint FKmn1l13u1iroqkv46h8dnxcmuw foreign key (patient_id) references patient.patient;
alter table if exists examination.examination add constraint FKdosuxmxbt8wp48ejfuqf3obrw foreign key (staff_id) references medical_staff_management.staff;
alter table if exists examination.prescription add constraint FKbp2uci5mr8jae2gxi0fsaeo9 foreign key (examination_id) references examination.examination;
alter table if exists examination.prescription_item add constraint FK8n60qtfk33xobnq41pbuqgdcm foreign key (medicine_id) references pharmacy.medicine;
alter table if exists examination.prescription_item add constraint FKeykn9e2g6nbmvwhqbrdm3jb2p foreign key (prescription_id) references examination.prescription;
alter table if exists examination.service_order add constraint FKe9bpv4yx0lvo17a0s4n9abaom foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists examination.service_order add constraint FKrr2sedo7ttrgthc8vwfi51f49 foreign key (examination_id) references examination.examination;
alter table if exists examination.service_order add constraint FKfmcxldtpbtnhwkl9ry5ex9poj foreign key (room_id) references organization.room;
alter table if exists examination.service_order_item add constraint FKrckasehfmti22mwideh2frhc foreign key (service_id) references examination.service_catalog;
alter table if exists examination.service_order_item add constraint FKa3mw659fei9nufwgfclf01r0t foreign key (service_order_id) references examination.service_order;
alter table if exists examination.vital_sign add constraint FKmvyj8fbuv55v2ku4hbgfjlqvp foreign key (examination_id) references examination.examination;
alter table if exists laboratory.lab_order add constraint FKigw1v0tbe2yj42umio3x3wwe0 foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists laboratory.lab_order add constraint FKr3qnaiuravkb9r78yteabiy3g foreign key (examination_id) references examination.examination;
alter table if exists laboratory.lab_order add constraint FK39tx4ti1irlt5totq8sd379ht foreign key (patient_id) references patient.patient;
alter table if exists laboratory.lab_order add constraint FKb58faixgv208y1vg20kh8btb3 foreign key (requested_by) references medical_staff_management.staff;
alter table if exists laboratory.lab_order add constraint FKiqmcaluukwk6n0sr70y011k6 foreign key (room_id) references organization.room;
alter table if exists laboratory.lab_test_result add constraint FKa0kdkrqxlqknp0yjfmjkgi1rv foreign key (lab_order_id) references laboratory.lab_order;
alter table if exists laboratory.lab_test_result add constraint FKhr48uweodmkv4xog5uxolsjwy foreign key (lab_test_id) references laboratory.lab_test;
alter table if exists laboratory.lab_test_result add constraint FKenyp8vtteop8aikfl7dpbcj9y foreign key (verified_by) references medical_staff_management.staff;
alter table if exists medical_staff_management.specialty add constraint FKlps74l72wvj96da9q5pnwyguk foreign key (department_id) references organization.department;
alter table if exists medical_staff_management.staff add constraint FK686rqn8cpu4ncey4odd8cw3hm foreign key (department_id) references organization.department;
alter table if exists medical_staff_management.staff add constraint FK97leb33cm0q32draq913xcxe1 foreign key (position_id) references medical_staff_management.position;
alter table if exists medical_staff_management.staff add constraint FKlltx599l1kpr1mo8e3tygglp4 foreign key (specialty_id) references medical_staff_management.specialty;
alter table if exists medical_staff_management.staff add constraint FKdlvw23ak3u9v9bomm8g12rtc0 foreign key (user_id) references user_management.users;
alter table if exists medical_staff_management.staff_schedule add constraint FKq4g0j5i832j2sng2r21x3wenk foreign key (room_id) references organization.room;
alter table if exists medical_staff_management.staff_schedule add constraint FKkc1jgvvbu2m5pwmi0njsx5a7u foreign key (staff_id) references medical_staff_management.staff;
alter table if exists medical_staff_management.staff_schedule_template add constraint FKobtflvnvhhti64qlgg0eq6mu5 foreign key (room_id) references organization.room;
alter table if exists medical_staff_management.staff_schedule_template add constraint FKni66a5abyy7d9lnmr7cmp8npj foreign key (staff_id) references medical_staff_management.staff;
alter table if exists organization.clinic add constraint FK15djxm3mj8bmp7mv7gdm6m1du foreign key (address_id) references common.address;
alter table if exists organization.department add constraint FK6io2v0mkg9sp6i0vgm9p1oem2 foreign key (clinic_id) references organization.clinic;
alter table if exists organization.room add constraint FKfbxs68qt7hfp6rkqan2eqbtyq foreign key (department_id) references organization.department;
alter table if exists patient.allergy add constraint FKg2ytn0t43rqrd6ag29e9hiowq foreign key (patient_id) references patient.patient;
alter table if exists patient.emergency_contact add constraint FK89nspxrjggthmmdr3o72n264x foreign key (patient_id) references patient.patient;
alter table if exists patient.medical_record add constraint FKbjbdpykbr7ea0c3fbnfxakw2h foreign key (examination_id) references examination.examination;
alter table if exists patient.medical_record add constraint FKt0lf3feuiurr73bpln2n6x0v foreign key (patient_id) references patient.patient;
alter table if exists patient.patient add constraint FKie6vajiyur53rjcl5nc2pe83t foreign key (user_id) references user_management.users;
alter table if exists pharmacy.dispense_record add constraint FKdy43lfntaxp6037at0rxvsaho foreign key (dispensed_by) references medical_staff_management.staff;
alter table if exists pharmacy.dispense_record add constraint FK94y7rabvmvq9wn2s4c1uwxc2q foreign key (patient_id) references patient.patient;
alter table if exists pharmacy.dispense_record add constraint FKf5ychtfp3ayur01j3y0gcr8kj foreign key (prescription_id) references examination.prescription;
alter table if exists pharmacy.dispense_record add constraint FKqod51e3jio2x3sa8chjl4soe4 foreign key (room_id) references organization.room;
alter table if exists user_management.device_session add constraint FKd5djcii31tjhvjnhj74vnsk85 foreign key (user_id) references user_management.users;
alter table if exists user_management.user_profile add constraint FKt7ck1erxe5phbhrdk1cn92h52 foreign key (address_id) references common.address;
alter table if exists user_management.user_profile add constraint FKuganfwvnbll4kn2a3jeyxtyi foreign key (user_id) references user_management.users;
alter table if exists role_permissions add constraint FKclluu29apreb6osx6ogt4qe16 foreign key (permissions_id) references user_management.permission;
alter table if exists role_permissions add constraint FKlodb7xh4a2xjv39gc3lsop95n foreign key (role_id) references user_management.role;
alter table if exists users_roles add constraint FK15d410tj6juko0sq9k4km60xq foreign key (roles_id) references user_management.role;
alter table if exists users_roles add constraint FK2o0jvgh89lemvvo17cbqvdxaa foreign key (user_id) references user_management.users;
create table appointment.appointment (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, specialty_id uuid not null, source varchar(30) check (source in ('SYSTEM','STAFF_CREATED','PATIENT_PORTAL','MOBILE_APP','WALK_IN')), status varchar(30) check (status in ('PENDING','CONFIRMED','CHECKED_IN','IN_PROGRESS','COMPLETED','CANCELLED','NO_SHOW')), type varchar(30) check (type in ('CONSULTATION','FOLLOW_UP','EMERGENCY','ONLINE')), created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table appointment.queue_ticket (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, queue_number varchar(10) not null, appointment_id uuid not null unique, doctor_id uuid not null, examination_id uuid unique, id uuid not null, room_id uuid not null, priority varchar(20) check (priority in ('NORMAL','HIGH')), status varchar(30) check (status in ('WAITING','CALLED','IN_SERVICE','IN_SERVICE_WAITING_RESULT','WAITING_AFTER_RESULT','SKIPPED','DONE','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table authentication.auth_token_blacklist (deleted boolean not null, version integer, created_date timestamp(6) with time zone, expires_at timestamp(6) with time zone, revoked_at timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, jti varchar(128) not null unique, created_by varchar(255), reason varchar(255), updated_by varchar(255), primary key (id));
create table authentication.login_attempt (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, status varchar(20) not null check (status in ('SUCCESS','MFA_PENDING','FAILURE','LOCKED')), ip_address varchar(45), created_by varchar(255), login_method varchar(255), updated_by varchar(255), user_agent varchar(255), primary key (id));
create table authentication.mfa_backup_code (deleted boolean not null, used boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, code_hash varchar(255) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table authentication.mfa_config (deleted boolean not null, is_primary boolean not null, revoked boolean not null, version integer, created_date timestamp(6) with time zone, last_verified_at timestamp(6) with time zone, sign_count bigint, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, mfa_type varchar(32) not null check (mfa_type in ('TOTP','SMS','EMAIL','PUSH_NOTIFICATION','PASSKEY','EMAIL_VERIFICATION')), aaguid varchar(100), credential_id varchar(200) unique, attestation_format varchar(255), contact varchar(255), created_by varchar(255), device_name varchar(255), secret varchar(255), updated_by varchar(255), public_key bytea, primary key (id));
create table authentication.oauth_account (deleted boolean not null, is_revoke boolean, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, provider varchar(20) not null check (provider in ('GOOGLE','FACEBOOK','GITHUB')), avatar_url varchar(500), created_by varchar(255), email varchar(255), name varchar(255), provider_user_id varchar(255) not null, updated_by varchar(255), primary key (id), constraint uc_oauthaccount_provider_user_id unique (provider, provider_user_id));
create table authentication.otp_challenge (attempt_count integer not null, deleted boolean not null, verified boolean not null, version integer, created_date timestamp(6) with time zone, expires_at timestamp(6) with time zone not null, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid not null, mfa_type varchar(30) not null check (mfa_type in ('TOTP','SMS','EMAIL','PUSH_NOTIFICATION','PASSKEY','EMAIL_VERIFICATION')), code varchar(255) not null, created_by varchar(255), updated_by varchar(255), metadata jsonb, primary key (id));
create index idx_loginattempt_user_id on authentication.login_attempt (user_id);
create index idx_loginattempt_ip_address on authentication.login_attempt (ip_address);
create index idx_mfa_backup_code_user_id on authentication.mfa_backup_code (user_id);
create index idx_oauthaccount_user_id on authentication.oauth_account (user_id);
create index idx_oauthaccount_provider_user_id on authentication.oauth_account (provider_user_id);
create index idx_otpchallenge_user_id on authentication.otp_challenge (user_id);
create index idx_otpchallenge_mfa_type on authentication.otp_challenge (mfa_type);
create table billing.invoice (deleted boolean not null, paid boolean not null, total_amount numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, issue_date timestamp(6) not null, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid unique, id uuid not null, patient_id uuid not null, room_id uuid, invoice_number varchar(30) not null unique, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table billing.invoice_item (deleted boolean not null, quantity integer not null, total_price numeric(38,2) not null, unit_price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, invoice_id uuid not null, created_by varchar(255), description varchar(255) not null, updated_by varchar(255), primary key (id));
create table common.address (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, ward_id uuid, city_name varchar(255), created_by varchar(255), district_name varchar(255), street varchar(255), updated_by varchar(255), ward_name varchar(255), primary key (id));
create table common.administrative_unit (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, code varchar(10) not null unique, id uuid not null, parent_id uuid, level varchar(20) not null check (level in ('PROVINCE','DISTRICT','WARD')), name varchar(100) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table common.file_attachment (deleted boolean not null, version integer, created_date timestamp(6) with time zone, size bigint not null, updated_date timestamp(6) with time zone, id uuid not null, content_type varchar(255) not null, created_by varchar(255), entity_id varchar(255), entity_type varchar(255), file_name varchar(255) not null, updated_by varchar(255), upload_purpose varchar(255), url varchar(255) not null, primary key (id));
create table common.icd_code (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, code varchar(10) not null unique, id uuid not null, icd_version varchar(20), chapter varchar(100), created_by varchar(255), description TEXT, name varchar(255) not null, updated_by varchar(255), primary key (id));
create table common.notification (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, created_by varchar(255), message varchar(255), reference_id varchar(255), status varchar(255) check (status in ('READ','UNREAD')), title varchar(255) not null, topic varchar(255), type varchar(255) check (type in ('QUEUE_NEW','ORDER_NEW','LAB_ORDER_NEW','PAYMENT_NEW','APPOINTMENT_NEW')), updated_by varchar(255), primary key (id));
create table content_management.content (deleted boolean not null, version integer, created_date timestamp(6) with time zone, published_at timestamp(6) with time zone, updated_date timestamp(6) with time zone, author_id uuid not null, id uuid not null, status varchar(20) not null check (status in ('DRAFT','PUBLISHED','ARCHIVED')), title varchar(200) not null, slug varchar(220) not null unique, cover_image_url varchar(500), excerpt varchar(500), body jsonb not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table content_management.content_tag (content_id uuid not null, tag varchar(50) not null, primary key (content_id, tag));
create table examination.diagnosis (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null, icd_code_id uuid, id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.examination (deleted boolean not null, version integer, created_date timestamp(6) with time zone, examination_date timestamp(6) not null, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, staff_id uuid not null, status varchar(32) check (status in ('ONGOING','COMPLETED','CANCELLED')), type varchar(50) check (type in ('GENERAL','SPECIALIST','FOLLOW_UP','EMERGENCY')), created_by varchar(255), diagnosis_summary TEXT, symptom TEXT, updated_by varchar(255), primary key (id));
create table examination.prescription (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null unique, id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.prescription_item (deleted boolean not null, quantity integer, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, medicine_id uuid not null, prescription_id uuid not null, dosage varchar(50), duration varchar(50), frequency varchar(50), created_by varchar(255), instruction TEXT, updated_by varchar(255), primary key (id));
create table examination.service_catalog (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(20) not null unique, room_type varchar(50) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), category varchar(500), name varchar(500) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table examination.service_order (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid not null, id uuid not null, room_id uuid, order_code varchar(20) not null unique, status varchar(30) check (status in ('PENDING','READY','IN_PROGRESS','COMPLETED','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table examination.service_order_item (deleted boolean not null, price numeric(38,2), version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, service_id uuid not null, service_order_id uuid not null, created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table examination.vital_sign (deleted boolean not null, height float(53), pulse integer, respiration_rate integer, temperature float(53), version integer, weight float(53), created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid not null, id uuid not null, blood_pressure varchar(20), created_by varchar(255), updated_by varchar(255), primary key (id));
create table laboratory.lab_order (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, assigned_staff_id uuid, examination_id uuid, id uuid not null, patient_id uuid not null, requested_by uuid not null, room_id uuid, order_code varchar(30) not null unique, status varchar(30) check (status in ('PENDING','IN_PROGRESS','COMPLETED','VERIFIED','CANCELLED')), created_by varchar(255), updated_by varchar(255), primary key (id));
create table laboratory.lab_test (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(20) not null unique, unit varchar(50), name varchar(150) not null, reference_range varchar(300), category varchar(500), created_by varchar(255), description TEXT, room_type varchar(255) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), updated_by varchar(255), primary key (id));
create table laboratory.lab_test_result (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, verified_at timestamp(6), id uuid not null, lab_order_id uuid not null, lab_test_id uuid not null, verified_by uuid, status varchar(30) check (status in ('PENDING','IN_PROGRESS','COMPLETED','VERIFIED','CANCELLED')), unit varchar(50), result_value varchar(100), reference_range varchar(500), created_by varchar(255), remark TEXT, updated_by varchar(255), primary key (id));
create table medical_staff_management.position (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, position_code varchar(20) not null unique, title varchar(100) not null unique, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table medical_staff_management.specialty (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, created_by varchar(255), description varchar(255), name varchar(255) not null, updated_by varchar(255), primary key (id));
create table medical_staff_management.staff (deleted boolean not null, experience_years integer, joined_date date, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, position_id uuid, specialty_id uuid, user_id uuid not null unique, staff_type varchar(32) check (staff_type in ('DOCTOR','NURSE','TECHNICIAN','LAB_TECHNICIAN','PHARMACIST','RECEPTIONIST','CASHIER','MANAGER','SYSTEM_ADMIN')), bio TEXT, created_by varchar(255), education varchar(255), email varchar(255) unique, full_name varchar(255), license_number varchar(255), phone varchar(255) unique, updated_by varchar(255), primary key (id));
create table medical_staff_management.staff_schedule (date date not null, deleted boolean not null, end_time time(6) not null, start_time time(6) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, room_id uuid not null, staff_id uuid not null, note varchar(500), created_by varchar(255), status varchar(255) not null check (status in ('AVAILABLE','OFF','CANCELLED','CHANGED')), updated_by varchar(255), primary key (id), constraint uk_staff_date_room_time unique (staff_id, date, room_id, start_time, end_time));
create table medical_staff_management.staff_schedule_template (active boolean not null, deleted boolean not null, end_time time(6) not null, start_time time(6) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, room_id uuid not null, staff_id uuid not null, created_by varchar(255), day_of_week varchar(255) not null check (day_of_week in ('MONDAY','TUESDAY','WEDNESDAY','THURSDAY','FRIDAY','SATURDAY','SUNDAY')), updated_by varchar(255), primary key (id));
create table organization.clinic (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, address_id uuid unique, id uuid not null, phone varchar(20), account_number varchar(50), tax_code varchar(50), email varchar(100), bank_name varchar(150), name varchar(150) not null unique, website varchar(150), created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table organization.department (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, clinic_id uuid not null, id uuid not null, name varchar(100) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table organization.room (capacity integer, deleted boolean not null, floor_number integer, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, department_id uuid not null, id uuid not null, room_type varchar(50) check (room_type in ('CONSULTATION','XRAY','ULTRASOUND','LABORATORY','PROCEDURE','PHARMACY','CASHIER','RECEPTION','WAITING_AREA','ENDOSCOPY','ECG','EEG','DEXA','CT_SCAN','MRI','OPTOMETRY','VACCINATION','PHYSIOTHERAPY','PFT','MINOR_SURGERY')), name varchar(100) not null, created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table patient.allergy (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, severity varchar(50), substance varchar(100) not null, created_by varchar(255), reaction TEXT, updated_by varchar(255), primary key (id));
create table patient.emergency_contact (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, patient_id uuid not null, phone varchar(20) not null, relationship varchar(50), full_name varchar(150) not null, created_by varchar(255), updated_by varchar(255), primary key (id));
create table patient.medical_record (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, examination_id uuid unique, id uuid not null, patient_id uuid not null, record_code varchar(20) not null unique, created_by varchar(255), diagnosis TEXT, treatment TEXT, updated_by varchar(255), primary key (id));
create table patient.patient (date_of_birth date, deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, gender varchar(10) check (gender in ('MALE','FEMALE','OTHER')), id uuid not null, user_id uuid not null unique, blood_type varchar(20) check (blood_type in ('A_POSITIVE','A_NEGATIVE','B_POSITIVE','B_NEGATIVE','AB_POSITIVE','AB_NEGATIVE','O_POSITIVE','O_NEGATIVE')), insurance_number varchar(20), patient_code varchar(20) not null unique, phone varchar(20), status varchar(20) check (status in ('ACTIVE','INACTIVE','DECEASED','TRANSFERRED')), email varchar(100), full_name varchar(150) not null, address varchar(255), created_by varchar(255), init_password varchar(255), updated_by varchar(255), primary key (id));
create table pharmacy.dispense_record (deleted boolean not null, total_cost numeric(38,2), version integer, created_date timestamp(6) with time zone, dispensed_at timestamp(6), updated_date timestamp(6) with time zone, dispensed_by uuid, id uuid not null, patient_id uuid not null, prescription_id uuid not null unique, room_id uuid, status varchar(30) check (status in ('PENDING','DISPENSED','CANCELLED')), created_by varchar(255), note TEXT, updated_by varchar(255), primary key (id));
create table pharmacy.medicine (deleted boolean not null, price numeric(38,2) not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, code varchar(30) not null unique, unit varchar(30), strength varchar(50), dosage_form varchar(100), name varchar(100) not null, active_ingredient varchar(500), created_by varchar(255), description TEXT, updated_by varchar(255), primary key (id));
create table user_management.device_session (deleted boolean not null, remember_me boolean not null, revoked boolean not null, trusted boolean not null, version integer, created_date timestamp(6) with time zone, expires_in timestamp(6) with time zone, last_login_at timestamp(6) with time zone, last_refreshed_at timestamp(6) with time zone, refresh_count bigint, updated_date timestamp(6) with time zone, id uuid not null, user_id uuid, ip_address varchar(45), device_id varchar(100) not null, access_token_id varchar(255), created_by varchar(255), device_name varchar(255), refresh_token_id varchar(255), updated_by varchar(255), user_agent varchar(255), primary key (id), constraint uc_devicesession_user_id_device_id unique (user_id, device_id));
create table user_management.permission (deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, name varchar(100) not null unique, created_by varchar(255), description varchar(255), updated_by varchar(255), primary key (id));
create table user_management.role (deleted boolean not null, is_default boolean, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, name varchar(50) not null unique, created_by varchar(255), description varchar(255), updated_by varchar(255), primary key (id));
create table user_management.user_profile (date_of_birth date, deleted boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, phone varchar(15) unique, address_id uuid unique, id uuid not null, user_id uuid not null unique, full_name varchar(100) not null, avatar_url varchar(255), created_by varchar(255), updated_by varchar(255), primary key (id));
create table user_management.users (active boolean not null, deleted boolean not null, first_login boolean not null, locked boolean not null, mfa_enabled boolean not null, version integer, created_date timestamp(6) with time zone, updated_date timestamp(6) with time zone, id uuid not null, username varchar(50) not null unique, created_by varchar(255), email varchar(255) unique, password varchar(255) not null, updated_by varchar(255), primary key (id), constraint idx_user_phone_unq unique (phone));
create index idx_devicesession_user_id on user_management.device_session (user_id);
create index idx_devicesession_device_id on user_management.device_session (device_id);
create index idx_userprofile_full_name on user_management.user_profile (full_name);
create table role_permissions (permissions_id uuid not null, role_id uuid not null, primary key (role_id, permissions_id));
create table users_roles (roles_id uuid not null, user_id uuid not null, primary key (roles_id, user_id));
alter table if exists appointment.appointment add constraint FK4apif2ewfyf14077ichee8g06 foreign key (patient_id) references patient.patient;
alter table if exists appointment.appointment add constraint FK2xk31jxbwpoobso94jdscytej foreign key (specialty_id) references medical_staff_management.specialty;
alter table if exists appointment.queue_ticket add constraint FKg0x1vvij9fdm7tvguubv61sgy foreign key (appointment_id) references appointment.appointment;
alter table if exists appointment.queue_ticket add constraint FKq40ac9eew03gdlnevyj5rdna2 foreign key (doctor_id) references medical_staff_management.staff;
alter table if exists appointment.queue_ticket add constraint FK6w6r44molpv2tl5ak1d9dl5mt foreign key (room_id) references organization.room;
alter table if exists appointment.queue_ticket add constraint FKav8oigrub7qod5n6da8kdi42r foreign key (examination_id) references examination.examination;
alter table if exists authentication.login_attempt add constraint FKocc7qiteno4e2mj9ww8fu6w6c foreign key (user_id) references user_management.users;
alter table if exists authentication.mfa_backup_code add constraint FK4gyfo4vgpnpfvsh64t31n7oqo foreign key (user_id) references user_management.users;
alter table if exists authentication.mfa_config add constraint FK3glxtej7nhswmb4f83bjnlgph foreign key (user_id) references user_management.users;
alter table if exists authentication.oauth_account add constraint FKfo0bd94g5i95ufayqbge39p2f foreign key (user_id) references user_management.users on delete cascade;
alter table if exists authentication.otp_challenge add constraint FKjntybiuc05f9f4y6xiy2f3ays foreign key (user_id) references user_management.users;
alter table if exists billing.invoice add constraint FKltqsckn6etx5w9cpcxhwgqhef foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists billing.invoice add constraint FKhbmd5jvpve5bo8blx5edcob4t foreign key (examination_id) references examination.examination;
alter table if exists billing.invoice add constraint FKooyykfsat84yeqr06yx3h5392 foreign key (patient_id) references patient.patient;
alter table if exists billing.invoice add constraint FK938ysly43px2i4fwfsp3vjbat foreign key (room_id) references organization.room;
alter table if exists billing.invoice_item add constraint FKbu6tmpd0mtgu9wrw5bj5uv09v foreign key (invoice_id) references billing.invoice;
alter table if exists common.address add constraint FKh8wc5qrs39wmsct8cg1fnd0cg foreign key (ward_id) references common.administrative_unit;
alter table if exists common.administrative_unit add constraint FKcd12wdp73q0vo69vsb49u50po foreign key (parent_id) references common.administrative_unit;
alter table if exists common.notification add constraint FKnk4ftb5am9ubmkv1661h15ds9 foreign key (user_id) references user_management.users;
alter table if exists content_management.content add constraint FKfrpvw5cl6uk0qlk9oobhjj4ok foreign key (author_id) references medical_staff_management.staff;
alter table if exists content_management.content_tag add constraint FKs7joyi8avvjnbkog3yx966mb5 foreign key (content_id) references content_management.content;
alter table if exists examination.diagnosis add constraint FKam2l2v2anxv27ab14dgvfvnvp foreign key (examination_id) references examination.examination;
alter table if exists examination.diagnosis add constraint FKbtrl1uxws2nfcd1a57ol2xo6d foreign key (icd_code_id) references common.icd_code;
alter table if exists examination.examination add constraint FKmn1l13u1iroqkv46h8dnxcmuw foreign key (patient_id) references patient.patient;
alter table if exists examination.examination add constraint FKdosuxmxbt8wp48ejfuqf3obrw foreign key (staff_id) references medical_staff_management.staff;
alter table if exists examination.prescription add constraint FKbp2uci5mr8jae2gxi0fsaeo9 foreign key (examination_id) references examination.examination;
alter table if exists examination.prescription_item add constraint FK8n60qtfk33xobnq41pbuqgdcm foreign key (medicine_id) references pharmacy.medicine;
alter table if exists examination.prescription_item add constraint FKeykn9e2g6nbmvwhqbrdm3jb2p foreign key (prescription_id) references examination.prescription;
alter table if exists examination.service_order add constraint FKe9bpv4yx0lvo17a0s4n9abaom foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists examination.service_order add constraint FKrr2sedo7ttrgthc8vwfi51f49 foreign key (examination_id) references examination.examination;
alter table if exists examination.service_order add constraint FKfmcxldtpbtnhwkl9ry5ex9poj foreign key (room_id) references organization.room;
alter table if exists examination.service_order_item add constraint FKrckasehfmti22mwideh2frhc foreign key (service_id) references examination.service_catalog;
alter table if exists examination.service_order_item add constraint FKa3mw659fei9nufwgfclf01r0t foreign key (service_order_id) references examination.service_order;
alter table if exists examination.vital_sign add constraint FKmvyj8fbuv55v2ku4hbgfjlqvp foreign key (examination_id) references examination.examination;
alter table if exists laboratory.lab_order add constraint FKigw1v0tbe2yj42umio3x3wwe0 foreign key (assigned_staff_id) references medical_staff_management.staff;
alter table if exists laboratory.lab_order add constraint FKr3qnaiuravkb9r78yteabiy3g foreign key (examination_id) references examination.examination;
alter table if exists laboratory.lab_order add constraint FK39tx4ti1irlt5totq8sd379ht foreign key (patient_id) references patient.patient;
alter table if exists laboratory.lab_order add constraint FKb58faixgv208y1vg20kh8btb3 foreign key (requested_by) references medical_staff_management.staff;
alter table if exists laboratory.lab_order add constraint FKiqmcaluukwk6n0sr70y011k6 foreign key (room_id) references organization.room;
alter table if exists laboratory.lab_test_result add constraint FKa0kdkrqxlqknp0yjfmjkgi1rv foreign key (lab_order_id) references laboratory.lab_order;
alter table if exists laboratory.lab_test_result add constraint FKhr48uweodmkv4xog5uxolsjwy foreign key (lab_test_id) references laboratory.lab_test;
alter table if exists laboratory.lab_test_result add constraint FKenyp8vtteop8aikfl7dpbcj9y foreign key (verified_by) references medical_staff_management.staff;
alter table if exists medical_staff_management.specialty add constraint FKlps74l72wvj96da9q5pnwyguk foreign key (department_id) references organization.department;
alter table if exists medical_staff_management.staff add constraint FK686rqn8cpu4ncey4odd8cw3hm foreign key (department_id) references organization.department;
alter table if exists medical_staff_management.staff add constraint FK97leb33cm0q32draq913xcxe1 foreign key (position_id) references medical_staff_management.position;
alter table if exists medical_staff_management.staff add constraint FKlltx599l1kpr1mo8e3tygglp4 foreign key (specialty_id) references medical_staff_management.specialty;
alter table if exists medical_staff_management.staff add constraint FKdlvw23ak3u9v9bomm8g12rtc0 foreign key (user_id) references user_management.users;
alter table if exists medical_staff_management.staff_schedule add constraint FKq4g0j5i832j2sng2r21x3wenk foreign key (room_id) references organization.room;
alter table if exists medical_staff_management.staff_schedule add constraint FKkc1jgvvbu2m5pwmi0njsx5a7u foreign key (staff_id) references medical_staff_management.staff;
alter table if exists medical_staff_management.staff_schedule_template add constraint FKobtflvnvhhti64qlgg0eq6mu5 foreign key (room_id) references organization.room;
alter table if exists medical_staff_management.staff_schedule_template add constraint FKni66a5abyy7d9lnmr7cmp8npj foreign key (staff_id) references medical_staff_management.staff;
alter table if exists organization.clinic add constraint FK15djxm3mj8bmp7mv7gdm6m1du foreign key (address_id) references common.address;
alter table if exists organization.department add constraint FK6io2v0mkg9sp6i0vgm9p1oem2 foreign key (clinic_id) references organization.clinic;
alter table if exists organization.room add constraint FKfbxs68qt7hfp6rkqan2eqbtyq foreign key (department_id) references organization.department;
alter table if exists patient.allergy add constraint FKg2ytn0t43rqrd6ag29e9hiowq foreign key (patient_id) references patient.patient;
alter table if exists patient.emergency_contact add constraint FK89nspxrjggthmmdr3o72n264x foreign key (patient_id) references patient.patient;
alter table if exists patient.medical_record add constraint FKbjbdpykbr7ea0c3fbnfxakw2h foreign key (examination_id) references examination.examination;
alter table if exists patient.medical_record add constraint FKt0lf3feuiurr73bpln2n6x0v foreign key (patient_id) references patient.patient;
alter table if exists patient.patient add constraint FKie6vajiyur53rjcl5nc2pe83t foreign key (user_id) references user_management.users;
alter table if exists pharmacy.dispense_record add constraint FKdy43lfntaxp6037at0rxvsaho foreign key (dispensed_by) references medical_staff_management.staff;
alter table if exists pharmacy.dispense_record add constraint FK94y7rabvmvq9wn2s4c1uwxc2q foreign key (patient_id) references patient.patient;
alter table if exists pharmacy.dispense_record add constraint FKf5ychtfp3ayur01j3y0gcr8kj foreign key (prescription_id) references examination.prescription;
alter table if exists pharmacy.dispense_record add constraint FKqod51e3jio2x3sa8chjl4soe4 foreign key (room_id) references organization.room;
alter table if exists user_management.device_session add constraint FKd5djcii31tjhvjnhj74vnsk85 foreign key (user_id) references user_management.users;
alter table if exists user_management.user_profile add constraint FKt7ck1erxe5phbhrdk1cn92h52 foreign key (address_id) references common.address;
alter table if exists user_management.user_profile add constraint FKuganfwvnbll4kn2a3jeyxtyi foreign key (user_id) references user_management.users;
alter table if exists role_permissions add constraint FKclluu29apreb6osx6ogt4qe16 foreign key (permissions_id) references user_management.permission;
alter table if exists role_permissions add constraint FKlodb7xh4a2xjv39gc3lsop95n foreign key (role_id) references user_management.role;
alter table if exists users_roles add constraint FK15d410tj6juko0sq9k4km60xq foreign key (roles_id) references user_management.role;
alter table if exists users_roles add constraint FK2o0jvgh89lemvvo17cbqvdxaa foreign key (user_id) references user_management.users;
